<!DOCTYPE HTML>
<html style="height: 99%">
<head><!-- , 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif; -->
  <style>
    html {
      font-family: 'Lucida Sans'; 
    }
    #btn__back,
    #btn__forward {
      background-color: rgb(227, 7, 20);
      border: 20px solid rgb(227, 7, 20);
      cursor: pointer;
      position: relative;
    }

    #btn__back {
      border-left: none;
    }

    #btn__forward {
      border-right: none;
    }

    #btn__back::before,
    #btn__forward::before {
      border: 30px solid transparent;
      content: "";
      position: absolute;
      top: calc(50% - 30px);
    }

    #btn__back::before {
      border-right-color: rgb(227, 7, 20);
      left: -57px;
    }

    #btn__forward::before {
      border-left-color: rgb(227, 7, 20);
      right: -57px;
    }
  </style>
  <meta charset="UTF-8">
  <title>Main</title>
  <script src="main.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jsrsasign"></script>
</head>
<body style="height: 100%">
  <div id="2voor12"></div>
  <script>
    
    const asdf1 = "-----BEGIN PRIVATE KEY-----\n"
    const asdf2 = "MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwg"
    const asdf3 = "gSjAgEAAoIBAQDC0c11myb8+4PJ\n0XL6kfMiwtilK2"
    const asdf4 = "+/862RdR7EXhAY+wTj+mRTbLJC+tsBnEq9oCY+LPZSAf"
    const asdf5 = "89Mg4s\nhD69Rr1lL0psORQ5i4RG62QGexdOd1efy+SC1"
    const asdf6 = "wR299cd8n7C4dlCMvk9kk6UkKDA\nrtCThrgV/xNbKxlQCb2"
    const asdf7 = "WfKuM9otK7UZbmz/u8jQQu669qR6bKyeDLnpmxtws7fbU\nu"
    const asdf8 = "RdmlAMLoSgAJnW67lR5ELz/+S0eya8tpQQiEgX4XLuIcx/Jz"
    const asdf9 = "IXSHnS9cVRQPkNg\nfrlL4gOcI4Th0lqTYfDyjv"
    const asdfA = "SxN7NT7DaZWhSLKDHQ5U2CYHmWkvSZmAMH6FhzgNNB"
    const asdfB = "\nhfdQ5NnVAgMBAAECggEAXJMhlK8DWdeSikZS4qqT5IK"
    const asdfC = "+O85mLcp3QdVrp1gjQhuV\n+Vc0cUgHdTiK9Tr1cSI2yfjHm7SDOus"
    const asdfD = "cPR8iSQLiYMCWFtMQvz+CvciBIWtAafLf\n2nkivuG5p2ah/AMNJUH44"
    const asdfE = "TIjqZRqbsJDAQyQ5Glx9FHfOsVCI/xc8LOROUy2aAV+\n3ZqIOmDs06Pf"
    const asdfF = "NgUdbe4NHcUNFs5Px9+ft+xTazm6ue4315seRymtcqMhsp2rAFtO\niZC4ZAufMaoX"
    const asdfG = "/M0YmHm6UMvV2pp1kQAOPiRK1MTvl2T4l0PBSFABp5j9kf2CCtE7\nVvoGHTs80VjqFSeDAQFkbx+"
    const asdfH = "faUSo9W3967/cTDJEiQKBgQD14QwWya3EyNTy6RDG\nqxJWOEqhWHwFOG5pb6KQJtNdlnzxGteMG/8uyzmP7feSjCvvf"
    const asdfI = "/itr9CvknhhcvcR\n0h3wWsH6iO51PGVivb2TrZ4YfElrjAtGzJDgwQKktwwKXaHKDuWQGPBS6AUyN2Af"
    const asdfJ = "\nCwAwVO2uTkpcEJqQz7uCYT3uHwKBgQDK1rcH9eRPzvksXmY8hb7ceUjeoWSuCEgN\nLTjDdYErMKQopJsRQeEmqbWJDw1YfzJy1+"
    const asdfK = "IEbua0nBptuS1Koz1AMynZydcx6St/\nsvXyZXbVLFekJJmt/a99ypLtr5pB033REyIGWehYmYz4VteUQ8GtS9EPpl1F4ETy"
    const asdfL = "\nk74xCPuRiwKBgHU3WzcF4HRetb4zw86iQXSfE10FvOIUO/bBxILqL3t/QYMDo9xk\ngG"
    const asdfM = "vDcGagMJVJg6yCmn/awCbjMcZrM0PoomMyMSWJ3/w91auT"
    const asdfN = "/uuHKkZMAghmU/3l\nie/Ls8HojbHnXzjfjyr56J/tgoSlB4rlCKsB4ell42cudzEwBxkp2IdLAoGBAJ5K\nw"
    const asdfO = "btsoSfHFZ0SbiZ9GV1lKQDUYoWN4OynhczDPnI+G128V2c4SkSp3AmBvaB6YxxM"
    const asdfP = "\nbQ2YnmIEEHvgLwA4M+yOAPL9GPrSRCf7uQPZOstRN3PZPDUT7If2NoNWrsMAEQfA\nLqVWNIQwEFsdKk"
    const asdfQ = "+CMPrUV+omolONmUDVG2+Y2vnRAoGAYLwV2F7vjxirkFHV/y6K\n80DnGshJe64fCW1R0mne6"
    const asdfR = "27rW4VAqnGa40J2El8wLfK0oP5dkLqjmLvjNbtBqsyB\nsJ4aiyYfV6RnDOQGo74N2mGmt3pYILcE"
    const asdfS = "kORKU7Yuav/0b+iev3wHSwIpQxtB2FWG\nilyszbXAXEX5WI1x1UlETq8=\n"
    const asdfT = "-----END PRIVATE KEY-----\n"

    

    const scopes = ['https://www.googleapis.com/auth/spreadsheets'];

    async function getAccessToken() {
      const header = {
        alg: 'RS256',
        typ: 'JWT'
      };

      const now = Math.floor(Date.now() / 1000);
      const payload = {
        iss: "voor12@voor-12.iam.gserviceaccount.com",
        scope: scopes.join(' '),
        aud: "https://oauth2.googleapis.com/token",
        exp: now + 3600,
        iat: now
      };

      const sHeader = JSON.stringify(header);
      const sPayload = JSON.stringify(payload);
      const privateKey = 
        asdf1.concat(asdf2
                    ,asdf3
                    ,asdf4
                    ,asdf5
                    ,asdf6
                    ,asdf7
                    ,asdf8
                    ,asdf9
                    ,asdfA
                    ,asdfB
                    ,asdfC
                    ,asdfD
                    ,asdfE
                    ,asdfF
                    ,asdfG
                    ,asdfH
                    ,asdfI
                    ,asdfJ
                    ,asdfK
                    ,asdfL
                    ,asdfM
                    ,asdfN
                    ,asdfO
                    ,asdfP
                    ,asdfQ
                    ,asdfR
                    ,asdfS
                    ,asdfT);

      const jwt = KJUR.jws.JWS.sign('RS256', sHeader, sPayload, privateKey);

      const res = await fetch("https://oauth2.googleapis.com/token", {
        method: 'POST',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
        },
        body: new URLSearchParams({
          grant_type: 'urn:ietf:params:oauth:grant-type:jwt-bearer',
          assertion: jwt
        })
      });

      const data = await res.json();

      if (data.access_token) {
        console.log('Access Token:', data.access_token);
        return data.access_token;
      } else {
        console.error('Error getting access token:', data);
        throw new Error('OAuth failed');
      }
    }

    getAccessToken().then(token => {
      var app = Elm.Main.init({
          node: document.getElementById('2voor12'),
          flags: token
        });
    });
  </script>
</body>
</html>
